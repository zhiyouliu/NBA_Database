use 21fa_zliu167_db;

DROP TABLE IF EXISTS injuries_10_20;
CREATE TABLE injuries_10_20 (
    
    Dates VARCHAR(10) NOT NULL,
    Team VARCHAR(15) NOT NULL,
    Acuqired VARCHAR(15) NOT NULL,
    PLAYER_NAME VARCHAR(15) NOT NULL,
    Notes VARCHAR(255) NOT NULL,
    PRIMARY KEY(Dates,PLAYER_NAME)
);




LOAD DATA local INFILE '/home/zliu167/data_final_project/injuries_2010-2020.csv' 
INTO TABLE injuries_10_20
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS ;


-- SELECT * FROM injuries_10_20;



DROP TABLE IF EXISTS games_details; 

CREATE TABLE games_details (
  GAME_ID varchar(10) NOT NULL,
  TEAM_ID varchar(15) NOT NULL,
  TEAM_ABBREVIATION varchar(5) NOT NULL,
  TEAM_CITY varchar(20) NOT NULL,
  PLAYER_ID int(15) NOT NULL,
  PLAYER_NAME varchar(25) NOT NULL,
  NICKNAME varchar(25) NOT NULL,
  START_POSITION varchar(5) NOT NULL,
  COMMENTS varchar(25) NOT NULL,
  MIN varchar(25) NOT NULL,
  FGM int(5) NOT NULL,
  FGA int(5) NOT NULL,
  FG_PCT decimal(5,5) NOT NULL,
  FG3M int(5) NOT NULL,
  FG3A int(5) NOT NULL,
  FG3_PCT decimal(5,5) NOT NULL,
  FTM int(5) NOT NULL,
  FTA int(5) NOT NULL,
  FT_PCT decimal(5,3) NOT NULL,
  OREB int(5) NOT NULL,
  DREB int(5) NOT NULL,
  REB int(5) NOT NULL,
  AST int(5) NOT NULL,
  STL int(5) NOT NULL,
  BLK int(5) NOT NULL,
  FOUL int(5) NOT NULL,
  PF int(5) NOT NULL,
  PTS int(5) NOT NULL,
  PLUS_MINUS int(5) NOT NULL,
  PRIMARY KEY(GAME_ID)
);


LOAD DATA local INFILE '/home/zliu167/data_final_project/games_details.csv' 
INTO TABLE games_details
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS ;


-- SELECT * FROM games_details;



DROP TABLE IF EXISTS games;
CREATE TABLE games (
  GAME_DATE_EST varchar(10) NOT NULL,
  GAME_ID varchar(15) NOT NULL,
  GAME_STATUS_TEXT varchar(10) NOT NULL,
  HOME_TEAM_ID int(15) NOT NULL,
  VISITOR_TEAM_ID int(15) NOT NULL,
  SEASON int(4) NOT NULL,
  TEAM_ID_home int(15) NOT NULL,
  PTS_home int(15) NOT NULL,
  FG_PCT_home decimal(6,5) NOT NULL,
  FT_PCT_home decimal(6,5) NOT NULL,
  FG3_PCT_home decimal(6,5) NOT NULL,
  AST_home int(3) NOT NULL,
  REB_home int(3) NOT NULL,
  TEAM_ID_away int(15) NOT NULL,
  PTS_away int(5) NOT NULL,
  FG_PCT_away decimal(6,5) NOT NULL,
  FT_PCT_away decimal(6,5) NOT NULL,
  FG3_PCT_away decimal(6,5) NOT NULL,
  AST_away int(3) NOT NULL,
  REB_away int(3) NOT NULL,
  HOME_TEAM_WINS int(2) NOT NULL,
  PRIMARY KEY(GAME_ID)
);



LOAD DATA local INFILE '/home/zliu167/data_final_project/games.csv' 
INTO TABLE games
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;


-- SELECT * FROM games limit 10;


DROP table IF EXISTS players;
CREATE TABLE players (
  PLAYER_NAME varchar(25) NOT NULL,
  TEAM_ID varchar(15) NOT NULL,
  PLAYER_ID varchar(15) NOT NULL,
  SEASON varchar(4) NOT NULL,
  PRIMARY KEY(TEAM_ID, PLAYER_ID, SEASON)
);


LOAD DATA local INFILE '/home/zliu167/data_final_project/players.csv' 
INTO TABLE players
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- SELECT * FROM players;

DROP table IF EXISTS ranking;
CREATE TABLE ranking (
  TEAM_ID varchar(15) NOT NULL,
  LEAGUE_ID varchar(2) NOT NULL,
  SEASON_ID varchar(6) NOT NULL,
  STANDINGSDATE varchar(10) NOT NULL,
  CONFERENCE varchar(4) NOT NULL,
  TEAM varchar(20) NOT NULL,
  G int(3) NOT NULL,
  W int(3) NOT NULL,
  L int(3) NOT NULL,
  W_PCT decimal(4,3) NOT NULL,
  HOME_RECORD varchar(10) NOT NULL,
  ROAD_RECORD varchar(10) NOT NULL,
  PRIMARY KEY(TEAM_ID,SEASON_ID, STANDINGSDATE)
);

LOAD DATA local INFILE '/home/zliu167/data_final_project/ranking2.csv' 
INTO TABLE ranking
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- SELECT * FROM ranking;



DROP TABLE IF EXISTS teams;

CREATE TABLE teams (
  LEAGUE_ID int(1) NOT NULL,
  TEAM_ID varchar(10) NOT NULL,
  MIN_YEAR int(4) NOT NULL,
  MAX_YEAR int(4) NOT NULL,
  ABBREVIATION varchar(5) NOT NULL,
  NICKNAME varchar(25) NOT NULL,
  YEARFOUNDED int(4) NOT NULL,
  CITY varchar(20) NOT NULL,
  ARENA varchar(20) NOT NULL,
  ARENACAPACITY int(6) NOT NULL,
  THE_OWNER varchar(20) NOT NULL,
  GENERALMANAGER varchar(20) NOT NULL,
  HEADCOACH varchar(20) NOT NULL,
  DLEAGUEAFFILIATION varchar(30) NOT NULL,
  PRIMARY KEY(TEAM_ID)
);

LOAD DATA local INFILE '/home/zliu167/data_final_project/teams.csv' 
INTO TABLE teams
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- SELECT * FROM teams;


DROP TABLE IF EXISTS Seasons_Stats;
CREATE TABLE Seasons_Stats(
  ID     VARCHAR(5),
  Year   INTEGER ,
  Player VARCHAR(24),
  Pos    VARCHAR(5),
  Age    INTEGER,
  Tm     VARCHAR(3),
  G      INTEGER, 
  GS     INTEGER,
  MP     INTEGER,
  PER    NUMERIC(5,1),
  TS_pc     NUMERIC(5,3),
  3PAr   NUMERIC(5,3),
  FTr    NUMERIC(5,3),
  ORB_pc    NUMERIC(4,1),
  DRB_pc    NUMERIC(4,1),
  TRB_pc    NUMERIC(4,1),
  AST_pc    NUMERIC(4,1),
  STL_pc    NUMERIC(4,1),
  BLK_pc    NUMERIC(4,1),
  TOV_pc    NUMERIC(4,1),
  USG_pc    NUMERIC(4,1),
  blanl  VARCHAR(30),
  OWS    NUMERIC(4,1),
  DWS    NUMERIC(4,1),
  WS     NUMERIC(4,1),
  WS48   NUMERIC(6,3),
  blank2 VARCHAR(30),
  OBPM   NUMERIC(5,1),
  DBPM   NUMERIC(5,1),
  BPM    NUMERIC(5,1),
  VORP   NUMERIC(4,1),
  FG     INTEGER,
  FGA    INTEGER, 
  FG_pc     NUMERIC(5,3),
  3P     INTEGER, 
  3PA    INTEGER, 
  3P_pc     NUMERIC(5,3),
  2P     INTEGER, 
  2PA    INTEGER, 
  2P_pc     NUMERIC(5,3),
  eFG_pc    NUMERIC(5,3),
  FT     INTEGER, 
  FTA    INTEGER,
  FT_pc     NUMERIC(5,3),
  ORB    INTEGER, 
  DRB    INTEGER, 
  TRB    INTEGER, 
  AST    INTEGER, 
  STL    INTEGER, 
  BLK    INTEGER, 
  TOV    INTEGER, 
  PF     INTEGER, 
  PTS    INTEGER,
  PRIMARY KEY(Player, Year)
);

LOAD DATA local INFILE '/home/zliu167/data_final_project/Seasons_Stats.csv' 
INTO TABLE Seasons_Stats
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

SELECT * from Seasons_Stats;



 DROP TABLE IF EXISTS Players;
CREATE TABLE  Players(
  ID INTEGER(5) NOT NULL,
  Player VARCHAR(25) NOT NULL,
  heights INTEGER(5) NOT NULL,
  weights INTEGER(5) NOT NULL,
  college VARCHAR(30) NOT NULL,
  born VARCHAR(5) NOT NULL,
  birth_city VARCHAR(30) NOT NULL,
  birth_state VARCHAR(30) NOT NULL,
  PRIMARY KEY(Player,heights)
);


LOAD DATA local INFILE '/home/zliu167/data_final_project/Players.csv' 
INTO TABLE Players
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- SELECT * from Players;

DROP TABLE IF EXISTS player_data;
CREATE TABLE player_data(
  player_name VARCHAR(25) NOT NULL,
  year_start VARCHAR(4) NOT NULL,
  year_end VARCHAR(4) NOT NULL,
  position VARCHAR(5) NOT NULL,
  heights VARCHAR(10) NOT NULL,
  weights VARCHAR(10) NOT NULL,
  birth_date VARCHAR(20) NOT NULL,
  college VARCHAR(30) NOT NULL,
  PRIMARY KEY(player_name,heights)
);

LOAD DATA local INFILE '/home/zliu167/data_final_project/player_data.csv' 
INTO TABLE player_data
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;


-- SELECT * from player_data;


DROP TABLE IF EXISTS NBASalaryData03_17;
CREATE TABLE NBASalaryData03_17(
  team VARCHAR(30) NOT NULL,
  salary INTEGER(15) NOT NULL,
  player VARCHAR(25) NOT NULL,
  position VARCHAR(5) NOT NULL,
  season VARCHAR(4) NOT NULL,
  PRIMARY KEY(season,player)
);

LOAD DATA local INFILE '/home/zliu167/data_final_project/NBASalaryData03-17.csv' 
INTO TABLE NBASalaryData03_17
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;


-- SELECT * from NBASalaryData03_17;



DROP TABLE IF EXISTS nba_elo;
CREATE TABLE nba_elo(
  dates         VARCHAR(15) NOT NULL,
  season        INTEGER  ,
  neutral       INTEGER  NOT NULL,
  playoff       VARCHAR(1),
  team1         VARCHAR(3) NOT NULL,
  team2         VARCHAR(3) NOT NULL,
  elo1_pre      VARCHAR(16) NOT NULL,
  elo2_pre      VARCHAR(16) NOT NULL,
  elo_prob1     VARCHAR(19) NOT NULL,
  elo_prob2     VARCHAR(20) NOT NULL,
  elo1_post     VARCHAR(16) NOT NULL,
  elo2_post     VARCHAR(16) NOT NULL,
  carmelo1_pre  VARCHAR(16) ,
  carmelo2_pre  VARCHAR(16) ,
  carmelo_prob1 VARCHAR(19) ,
  carmelo_prob2 VARCHAR(20) ,
  carmelo1_post VARCHAR(16) ,
  carmelo2_post VARCHAR(16) ,
  raptor1_pre   VARCHAR(16) ,
  raptor2_pre   VARCHAR(16) ,  
  raptor_prob1  VARCHAR(19) ,
  raptor_prob2  VARCHAR(20) ,
  score1        INTEGER,
  score2        INTEGER,
  PRIMARY KEY(dates,team1,team2) 
);
LOAD DATA local INFILE '/home/zliu167/data_final_project/nba_elo.csv' 
INTO TABLE nba_elo
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- SELECT * from nba_elo;
DELETE  FROM  nba_elo
WHERE   elo1_post =  '';  

DROP TABLE IF EXISTS ELO;
CREATE TABLE ELO AS
SELECT n.dates, n.season, n.team1 as TEAM_abb_home, n.team2 as TEAM_abb_away, n.elo1_pre as elo_home_pre, n.elo2_pre as elo_away_pre, n.elo_prob1 as elo_home_prob, n.elo_prob2 as elo_away_prob, n.elo1_post as elo_home_post, n.elo2_post as elo_away_post, n.score1 as score_home, n.score2 as score_away
FROM nba_elo as n
WHERE n.season >= 2009;

ALTER TABLE ELO ALTER COLUMN season SET DEFAULT NULL;
ALTER TABLE ELO ALTER COLUMN score_home SET DEFAULT NULL;
ALTER TABLE ELO ALTER COLUMN score_away SET DEFAULT NULL;
ALTER TABLE ELO ADD PRIMARY KEY(dates, TEAM_abb_home, TEAM_abb_away);

DROP TABLE IF EXISTS PI1;
create table PI1 as
SELECT *
From Players as P,players as p
where P.player = p.PLAYER_NAME ;

SELECT p.PLAYER_ID,p.PLAYER_NAME
FROM players p;

DROP TABLE IF EXISTS PI2;
create table PI2 as
SELECT *
From PI1
where 
PI1.born >= 1970;


DROP table IF EXISTS PLAYER_INFO_1;

CREATE table PLAYER_INFO_1 as
SELECT DISTINCT PI2.PLAYER_NAME, PI2.heights HEIGHTS, PI2.weights WEIGHTS, PI2.born BORN_YEAR, PI2.birth_city BIRTH_CITY, PI2.birth_state BIRTH_STATE, PI2.college COLLEGE
FROM PI2;
ALTER TABLE PLAYER_INFO_1 ADD PRIMARY KEY(PLAYER_NAME,WEIGHTS);


DROP TABLE IF EXISTS PC1;
create table PC1 as
SELECT PLI.PLAYER_NAME
From PLAYER_INFO_1 as PLI;


DROP TABLE IF EXISTS PLAYER_CAREER;
CREATE TABLE PLAYER_CAREER as 
SELECT DISTINCT pd.player_name, pd.year_start, pd.year_end, pd.position
FROM player_data as pd;
ALTER TABLE PLAYER_CAREER ADD PRIMARY KEY(player_name,year_start);
ALTER TABLE PLAYER_CAREER ADD FOREIGN KEY(player_name) REFERENCES PLAYER_INFO_1(PLAYER_NAME);


DROP TABLE IF EXISTS T1;
CREATE TABLE T1 AS
SELECT r.TEAM_ID, r.TEAM as TEAM_NAME
FROM ranking as r;



DROP TABLE IF EXISTS TEAMS;
CREATE TABLE TEAMS AS
SELECT DISTINCT t.TEAM_ID, t.ABBREVIATION, t.NICKNAME, t.YEARFOUNDED, t.CITY
FROM teams as t;
ALTER TABLE TEAMS ADD PRIMARY KEY(TEAM_ID);



DROP TABLE IF EXISTS R1;
CREATE TABLE R1
SELECT TEAM_ID, TEAM
FROM ranking;


-- SELECT DISTINCT t.TEAM_ID, R1.TEAM TEAM_NAME, t.ABBREVIATION, t.NICKNAME, t.YEARFOUNDED, t.CITY
-- FROM teams as t, R1
-- WHERE t.TEAM_ID = R1.TEAM_ID;
----------------




DROP TABLE IF EXISTS TEAMS_BASE;
CREATE TABLE TEAMS_BASE AS 
SELECT t.TEAM_ID, t.ARENA, t.ARENACAPACITY, t.THE_OWNER, t.GENERALMANAGER, t.HEADCOACH, t.DLEAGUEAFFILIATION
FROM teams as t;
ALTER TABLE TEAMS_BASE ADD PRIMARY KEY(TEAM_ID);
ALTER TABLE TEAMS_BASE ADD FOREIGN KEY(TEAM_ID) REFERENCES TEAMS(TEAM_ID);

-- SELECT DISTINCT team_name
-- FROM IN_IN




DROP TABLE IF EXISTS GAME;
CREATE TABLE GAME AS 
SELECT GAME_ID, GAME_DATE_EST, GAME_STATUS_TEXT, HOME_TEAM_ID, VISITOR_TEAM_ID, HOME_TEAM_WINS
FROM games;
ALTER TABLE GAME ADD PRIMARY KEY(GAME_ID);


DROP TABLE IF EXISTS GAME_DETAILS;
CREATE TABLE GAME_DETAILS
SELECT GAME_ID, SEASON, HOME_TEAM_ID, VISITOR_TEAM_ID, PTS_home, FG_PCT_home, FT_PCT_home, FG3_PCT_home, AST_home, REB_home, PTS_away, FG_PCT_away, FT_PCT_away,FG3_PCT_away, AST_away, REB_away
FROM games;
ALTER TABLE GAME_DETAILS ADD PRIMARY KEY(GAME_ID);
ALTER TABLE GAME_DETAILS ADD FOREIGN KEY(GAME_ID) REFERENCES GAME(GAME_ID);



DROP TABLE IF EXISTS RANKING;
CREATE TABLE RANKING AS
SELECT DISTINCT r.TEAM_ID, r.SEASON_ID, r.STANDINGSDATE, r.CONFERENCE, r.TEAM, r.G, r.W, r.L, r.W_PCT, r.HOME_RECORD, r.ROAD_RECORD
FROM ranking as r;
ALTER TABLE RANKING ADD PRIMARY KEY(TEAM_ID,SEASON_ID,STANDINGSDATE);
ALTER TABLE RANKING ADD FOREIGN KEY(TEAM_ID) REFERENCES TEAMS(TEAM_ID);
-- ALTER TABLE RANKING DROP PRIMARY KEY;


DROP TABLE IF EXISTS INJURY 
CREATE TABLE INJURY AS
SELECT i.Dates as dates, i.Team as Team_nickname, i.Relinquished as PLAYER_NAME, i.Notes
FROM injuries_10_20 as i
WHERE i.Dates >= '2009/01/01';
ALTER TABLE INJURY ADD PRIMARY KEY(dates,PLAYER_NAME);



DROP TABLE PLAY_IN;
CREATE TABLE PLAY_IN AS 
SELECT GAME_ID, PLAYER_ID, PLAYER_NAME, START_POSITION, COMMENTS, gd.MIN, FGM, FGA, FG_PCT, FG3M, FG3A, FG3_PCT, FTM, FTA, FT_PCT, OREB, DREB, REB, AST, STL, BLK, FOUL, PF, PTS, PLUS_MINUS
FROM games_details as gd;
ALTER TABLE INJURY ADD PRIMARY KEY(dates,PLAYER_NAME);
ALTER TABLE PLAY_IN ADD FOREIGN KEY(PLAYER_ID) REFERENCES PLAYER_INFO_1(PLAYER_ID);
ALTER TABLE PLAY_IN ADD FOREIGN KEY(GAME_ID) REFERENCES GAME(GAME_ID);

-- ALTER TABLE PLAY_IN CHANGE FG3A temp1 int(5);
-- ALTER TABLE PLAY_IN CHANGE FG3_PCT temp2 decimal(5,5);
-- ALTER TABLE PLAY_IN CHANGE temp1 FG3_PCT int(5);
-- ALTER TABLE PLAY_IN CHANGE temp2 FG3A decimal(5,5);



DROP TABLE IF EXISTS IN_IN;
CREATE TABLE IN_IN AS
SELECT team as team_name, player as player_name, season, salary
FROM NBASalaryData03_17 as N;
ALTER TABLE IN_IN ADD PRIMARY KEY(team_name,player_name,season);


-- DROP TABLE IN_IN;

-- CREATE TABLE IN_IN AS
-- SELECT team as team_name, player as player_name, season, salary
-- FROM NBASalaryData03_17 as N;


SELECT DISTINCT team_name FROM IN_IN;

SELECT * FROM IN_IN where team_name='NO/Oklahoma City  Hornets';

SELECT * FROM IN_IN where team_name='Seattle SuperSonics';

UPDATE IN_IN SET team_name = replace (team_name,'NO/Oklahoma City  Hornets','New Orleans Pelicans');


UPDATE IN_IN SET team_name = replace (team_name,'NO/Oklahoma City Hornets','New Orleans Pelicans');

UPDATE IN_IN SET team_name = replace (team_name,'New Orleans Hornets','New Orleans Pelicans');

UPDATE IN_IN SET team_name = replace (team_name,'Charlotte Bobcats','Charlotte Hornets');

UPDATE IN_IN SET team_name = replace (team_name,'New Jersey Nets','Brooklyn Nets');

UPDATE IN_IN SET team_name = replace (team_name,'Seattle SuperSonics','Oklahoma City Thunder');


SELECT DISTINCT team_name FROM IN_IN;



DROP TABLE IF EXISTS team_abb;
CREATE TABLE team_abb(
   team_name VARCHAR(22) NOT NULL PRIMARY KEY
  ,team_abb  VARCHAR(3) NOT NULL
  ,state VARCHAR(20) NOT NULL
);
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Minnesota Timberwolves','MIN','Minnesota');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Portland Trail Blazers','POR','Oregon');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('New York Knicks','NYK','New York');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Boston Celtics','BOS','Boston');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Phoenix Suns','PHX','Arizona');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('San Antonio Spurs','SAS','Texas');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Orlando Magic','ORL','Florida');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Indiana Pacers','IND','Indiana');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Los Angeles Lakers','LAL','California');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Toronto Raptors','TOR','Toronto');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Dallas Mavericks','DAL','Texas');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Sacramento Kings','SAC','California');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Miami Heat','MIA','Florida');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Milwaukee Bucks','MIL','Wisconsin');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Atlanta Hawks','ATL','Georgia');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Philadelphia 76ers','PHI','Pennsylvania');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Brooklyn Nets','BKN','New York');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Houston Rockets','HOU','Texas');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Utah Jazz','UTA','Utah');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Denver Nuggets','DEN','Colorado');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Detroit Pistons','DET','Michigan');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('New Orleans Pelicans','NOP','Louisiana');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Chicago Bulls','CHI','Illinois');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Memphis Grizzlies','MEM','Tennessee');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Golden State Warriors','GSW','California');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('LA Clippers','LAC','California');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Washington Wizards','WAS','District of Columbia');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Cleveland Cavaliers','CLE','Ohio');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Charlotte Hornets','CHA','North Carolina');
INSERT INTO team_abb(team_name,team_abb,state) VALUES ('Oklahoma City Thunder','OKC','Oklahoma');

ALTER TABLE team_abb ADD PRIMARY KEY(team_name);



select * from team_abb;

select * from IN_IN;

drop TABLE IF EXISTS R_IN_ABB;
create table R_IN_ABB as
select I.team_name, I.player_name, I.season, I.salary, t.team_abb, t.state
from IN_IN I, team_abb t
where I.team_name = t.team_name;
ALTER TABLE R_IN_ABB ADD PRIMARY KEY(team_name,player_name,season);
ALTER TABLE R_IN_ABB ADD FOREIGN KEY(TEAM_ID) REFERENCES TEAMS(TEAM_ID);





DROP TABLE IF EXISTS injuries_10_20;
CREATE TABLE injuries_10_20 (
    
    Name VARCHAR(30) NOT NULL,
    Team VARCHAR(30) NOT NULL,
    Position VARCHAR(10) NOT NULL,
    Dates VARCHAR(12) NOT NULL,
    Notes VARCHAR(50) NOT NULL
);



LOAD DATA local INFILE '/home/zliu167/data_final_project/Injury_History.csv' 
INTO TABLE injuries_10_20
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS ;



DROP TABLE IF EXISTS INJURY;
CREATE TABLE INJURY AS
SELECT DISTINCT i.Name,i.Dates as dates, i.Team,i.Position, i.Notes
FROM injuries_10_20 as i;
-- SELECT * FROM injuries_10_20;
ALTER TABLE INJURY ADD PRIMARY KEY(Name,dates,Notes);
-- ALTER TABLE INJURY ADD FOREIGN KEY(Team) REFERENCES TEAMS(TEAM_NAME);

-- select to_char(to_date(dates,'MM/DD/YYYY'), 'YYYY-MM-DD') from INJURY;

-- SELECT * FROM IF EXISTS INJURY;
DROP TABLE IF EXISTS CHAMP;
CREATE TABLE CHAMP(
   FIELD1 INTEGER  NOT NULL PRIMARY KEY 
  ,Year   INTEGER  NOT NULL
  ,Status VARCHAR(9) NOT NULL
  ,Team   VARCHAR(9) NOT NULL
  ,PTS    VARCHAR(16) NOT NULL
  ,FG     VARCHAR(16) NOT NULL
  ,FGA    VARCHAR(16) NOT NULL
  ,FGP    VARCHAR(16) NOT NULL
  ,TP     VARCHAR(17) NOT NULL
  ,TPA    VARCHAR(17) NOT NULL
  ,TPP    VARCHAR(16) NOT NULL
  ,FT     VARCHAR(16) NOT NULL
  ,FTA    VARCHAR(16) NOT NULL
  ,FTP    VARCHAR(16) NOT NULL
  ,ORB    VARCHAR(16) NOT NULL
  ,DRB    VARCHAR(16) NOT NULL
  ,TRB    VARCHAR(16) NOT NULL
  ,AST    VARCHAR(16) NOT NULL
  ,STL    VARCHAR(16) NOT NULL
  ,BLK    VARCHAR(16) NOT NULL
  ,TOV    VARCHAR(16) NOT NULL
  ,PF     VARCHAR(16) NOT NULL
);
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (1,1980,'Champion','Lakers','109.5','45','92','48.9130434782609','0','0.666666666666667','0','19.5','24','81.25','17.1666666666667','34.1666666666667','51.3333333333333','26.6666666666667','9.16666666666667','6.16666666666667','20','24.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (2,1980,'Runner Up','Sixers','104.166666666667','43','88.3333333333333','48.6792452830189','0.166666666666667','2.66666666666667','6.25','18','24','75','9.5','27.6666666666667','37.1666666666667','31','9.33333333333333','10','15.1666666666667','22.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (3,1981,'Champion','Celtics','96.5','40.1666666666667','85.3333333333333','47.0703125','0.5','2.83333333333333','17.6470588235294','15.6666666666667','21.5','72.8682170542636','16.6666666666667','30.6666666666667','47.3333333333333','22.8333333333333','6.66666666666667','5.33333333333333','16.8333333333333','23.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (4,1981,'Runner Up','Rockets','86.6666666666667','33.8333333333333','89.3333333333333','37.8731343283582','0.5','1.83333333333333','27.2727272727273','18.5','25.8333333333333','71.6129032258064','18.6666666666667','24','42.6666666666667','18','7.83333333333333','5.66666666666667','13.1666666666667','20.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (5,1982,'Champion','Lakers','112.333333333333','45.5','91.8333333333333','49.546279491833','0.166666666666667','1.5','11.1111111111111','21.1666666666667','31.5','67.1957671957672','18.3333333333333','29','47.3333333333333','31.3333333333333','10.6666666666667','7','19.3333333333333','25.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (6,1982,'Runner Up','Sixers','112.5','46.1666666666667','92.5','49.9099099099099','0.666666666666667','2.33333333333333','28.5714285714286','19.5','27.8333333333333','70.059880239521','15','26.6666666666667','41.6666666666667','28.6666666666667','8.83333333333333','8.5','16.6666666666667','26.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (7,1983,'Champion','Sixers','110.5','43','88.5','48.5875706214689','0','0.75','0','24.5','34.5','71.0144927536232','18','30','48','26','11','8','17','22.25');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (8,1983,'Runner Up','Lakers','100.5','40.75','90.25','45.1523545706371','0.75','3.75','20','18.25','23.25','78.494623655914','15.25','27.5','42.75','24.5','9','7.25','20','30');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (9,1984,'Champion','Celtics','116','42','92.8571428571429','45.2307692307692','1.28571428571429','3.28571428571429','39.1304347826087','30.7142857142857','38.5714285714286','79.6296296296296','17.4285714285714','30','47.4285714285714','24.1428571428571','9.85714285714286','4.57142857142857','15.8571428571429','28.1428571428571');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (10,1984,'Runner Up','Lakers','117.428571428571','46.7142857142857','90.7142857142857','51.496062992126','0.857142857142857','2.57142857142857','33.3333333333333','23.1428571428571','32.8571428571429','70.4347826086957','13.7142857142857','30','43.7142857142857','28.2857142857143','8.42857142857143','5.85714285714286','16.5714285714286','29.4285714285714');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (11,1985,'Champion','Lakers','115.833333333333','46.3333333333333','90.5','51.1970534069982','1.33333333333333','3.83333333333333','34.7826086956522','21.8333333333333','29.6666666666667','73.5955056179775','11','31.6666666666667','42.6666666666667','32','9.16666666666667','4','12.5','25.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (12,1985,'Runner Up','Celtics','113.166666666667','43.8333333333333','92','47.6449275362319','2.16666666666667','5.66666666666667','38.2352941176471','23.3333333333333','30.3333333333333','76.9230769230769','12.3333333333333','30.8333333333333','43.1666666666667','30.8333333333333','8.66666666666667','5','14','22.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (13,1986,'Champion','Celtics','107.666666666667','43.6666666666667','88.8333333333333','49.155722326454','1.66666666666667','5.33333333333333','31.25','18.6666666666667','23','81.1594202898551','15','30.1666666666667','45.1666666666667','28','9.83333333333333','7.16666666666667','15.8333333333333','21');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (14,1986,'Runner Up','Rockets','102','41.8333333333333','92.8333333333333','45.0628366247756','0.833333333333333','2.83333333333333','29.4117647058824','17.5','24.6666666666667','70.9459459459459','18.5','27','45.5','27.5','9','6.66666666666667','14.3333333333333','22.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (15,1987,'Champion','Lakers','115.166666666667','46.6666666666667','90.6666666666667','51.4705882352941','2.66666666666667','6.83333333333333','39.0243902439024','19.1666666666667','25.8333333333333','74.1935483870968','12.8333333333333','27.5','40.3333333333333','26.6666666666667','8','5.83333333333333','11.1666666666667','23.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (16,1987,'Runner Up','Celtics','111','43.6666666666667','86.1666666666667','50.6769825918762','2.33333333333333','7','33.3333333333333','21.3333333333333','27','79.0123456790123','12','29.3333333333333','41.3333333333333','27.8333333333333','5','5.5','13.6666666666667','21.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (17,1988,'Champion','Lakers','98.7142857142857','35.4285714285714','75.8571428571429','46.7043314500942','1.42857142857143','5.71428571428571','25','26.4285714285714','35.2857142857143','74.8987854251012','10.2857142857143','27.2857142857143','37.5714285714286','23.7142857142857','5.85714285714286','3','13.1428571428571','22');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (18,1988,'Runner Up','Pistons','101.285714285714','38.5714285714286','81','47.6190476190476','1.28571428571429','4.42857142857143','29.0322580645161','22.8571428571429','29.7142857142857','76.9230769230769','13.5714285714286','30','43.5714285714286','23.2857142857143','6.85714285714286','4.85714285714286','11.7142857142857','26.7142857142857');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (19,1989,'Champion','Pistons','109','41.75','79.25','52.6813880126183','1.25','5','25','24.25','31.25','77.6','11.25','28.75','40','24.25','4','5.25','11.25','28.75');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (20,1989,'Runner Up','Lakers','102.25','36','77.5','46.4516129032258','3.25','10.75','30.2325581395349','27','36','75','11.75','24.5','36.25','23','5.5','4','11.75','26');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (21,1990,'Champion','Pistons','107','39.4','86.8','45.3917050691244','5','11.2','44.6428571428571','23.2','31.4','73.8853503184713','14.4','29','43.4','18.8','5.6','5','15','27.6');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (22,1990,'Runner Up','Blazers','102','37.4','82','45.609756097561','2.2','9.4','23.4042553191489','25','33.8','73.9644970414201','11.4','29','40.4','20.6','7.2','3.4','16.4','29.8');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (23,1991,'Champion','Bulls','101.4','42.6','80.8','52.7227722772277','1','4.2','23.8095238095238','15.2','18.4','82.6086956521739','11','28.2','39.2','27.8','9.8','5','12.6','21.4');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (24,1991,'Runner Up','Lakers','91.6','33.4','74.8','44.6524064171123','2.6','9.2','28.2608695652174','22.2','27.4','81.021897810219','11.8','23.8','35.6','19.2','6.8','4.4','15','19.2');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (25,1992,'Champion','Bulls','104','40.1666666666667','79.6666666666667','50.418410041841','4.16666666666667','10.8333333333333','38.4615384615385','19.5','27.1666666666667','71.7791411042945','10.1666666666667','27.3333333333333','37.5','26.8333333333333','7','5.16666666666667','15','25.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (26,1992,'Runner Up','Blazers','96.6666666666667','35.3333333333333','79.8333333333333','44.258872651357','1.66666666666667','8.66666666666667','19.2307692307692','24.3333333333333','30.8333333333333','78.9189189189189','13.6666666666667','28.1666666666667','41.8333333333333','20.8333333333333','7.83333333333333','3.83333333333333','17','25.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (27,1993,'Champion','Bulls','106.666666666667','43.8333333333333','90.6666666666667','48.3455882352941','5.33333333333333','11.5','46.3768115942029','13.6666666666667','21.6666666666667','63.0769230769231','14.3333333333333','28.8333333333333','43.1666666666667','26.8333333333333','8','5.33333333333333','11.8333333333333','23.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (28,1993,'Runner Up','Suns','106.666666666667','40.6666666666667','86.8333333333333','46.8330134357006','4.5','10.3333333333333','43.5483870967742','20.8333333333333','26.8333333333333','77.639751552795','14.3333333333333','29','43.3333333333333','22.5','6.83333333333333','7.66666666666667','13.1666666666667','22.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (29,1994,'Champion','Rockets','86.1428571428571','31.8571428571429','74.7142857142857','42.6386233269599','5.28571428571429','17.2857142857143','30.5785123966942','17.1428571428571','22.7142857142857','75.4716981132075','10.5714285714286','29.4285714285714','40','20.8571428571429','7.14285714285714','5.14285714285714','15.4285714285714','21.2857142857143');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (30,1994,'Runner Up','Knicks','86.8571428571429','33.1428571428571','81.4285714285714','40.7017543859649','5.14285714285714','15','34.2857142857143','15.4285714285714','21.1428571428571','72.972972972973','15','28','43','21.7142857142857','8.14285714285714','6.14285714285714','12.7142857142857','22.8571428571429');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (31,1995,'Champion','Rockets','114','40.5','85.75','47.2303206997085','9.25','23','40.2173913043478','23.75','30.75','77.2357723577236','11','32.25','43.25','26.25','10','5','9.75','20.75');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (32,1995,'Runner Up','Magic','107','40.75','87.5','46.5714285714286','10.25','29.5','34.7457627118644','15.25','22.25','68.5393258426966','12','34','46','27.5','5.25','5','16','24.25');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (33,1996,'Champion','Bulls','93','32.8333333333333','79','41.5611814345992','6','22.8333333333333','26.2773722627737','21.3333333333333','28.1666666666667','75.7396449704142','16.8333333333333','24','40.8333333333333','21.6666666666667','8.33333333333333','4.16666666666667','13.3333333333333','24.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (34,1996,'Runner Up','Sonics','89.1666666666667','31','69.6666666666667','44.4976076555024','5.33333333333333','17','31.3725490196078','21.8333333333333','25.6666666666667','85.064935064935','11.1666666666667','26','37.1666666666667','16.8333333333333','6','2.66666666666667','16','25.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (35,1997,'Champion','Bulls','87.8333333333333','32.3333333333333','74.8333333333333','43.2071269487751','6.5','18.6666666666667','34.8214285714286','16.6666666666667','23.5','70.9219858156028','10.6666666666667','29.6666666666667','40.3333333333333','19.6666666666667','7.66666666666667','5.33333333333333','11.3333333333333','23.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (36,1997,'Runner Up','Jazz','87.1666666666667','30.8333333333333','71.6666666666667','43.0232558139535','5.83333333333333','14.1666666666667','41.1764705882353','19.6666666666667','26.8333333333333','73.2919254658385','10','30.8333333333333','40.8333333333333','20.1666666666667','7.33333333333333','3.5','12.8333333333333','22.8333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (37,1998,'Champion','Bulls','88','32.5','75.5','43.046357615894','4.33333333333333','14.6666666666667','29.5454545454545','18.6666666666667','24.6666666666667','75.6756756756757','12.1666666666667','25.5','37.6666666666667','18.3333333333333','10','4.5','12','21');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (38,1998,'Runner Up','Jazz','80.1666666666667','31.8333333333333','71.8333333333333','44.3155452436195','2.16666666666667','10','21.6666666666667','14.3333333333333','18.6666666666667','76.7857142857143','10.1666666666667','27.8333333333333','38','21.3333333333333','6.33333333333333','2.66666666666667','16.3333333333333','25');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (39,1999,'Champion','Spurs','84.8','30','67.4','44.5103857566766','4.2','12.4','33.8709677419355','20.6','28.2','73.0496453900709','8.4','32.2','40.6','20.2','6.4','5.8','15.4','20');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (40,1999,'Runner Up','Knicks','79.8','30.8','78.6','39.1857506361323','2.2','10.8','20.3703703703704','16','21','76.1904761904762','9.8','28.4','38.2','14','8','3.4','11.6','24.6');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (41,2000,'Champion','Lakers','104.833333333333','41','85.3333333333333','48.046875','5.83333333333333','15.3333333333333','38.0434782608696','17','29.8333333333333','56.9832402234637','12.1666666666667','29.1666666666667','41.3333333333333','23.3333333333333','6.83333333333333','5.16666666666667','10.8333333333333','26.6666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (42,2000,'Runner Up','Pacers','106.666666666667','36.3333333333333','78.5','46.2845010615711','8.16666666666667','19.3333333333333','42.2413793103448','25.8333333333333','30.3333333333333','85.1648351648352','8.66666666666667','32.5','41.1666666666667','20.1666666666667','5.5','4.33333333333333','10.8333333333333','26.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (43,2001,'Champion','Lakers','100.6','36.2','77.8','46.5295629820051','7.2','15','48','21','31','67.741935483871','13.4','31.8','45.2','23','8.2','8.8','14.8','23.2');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (44,2001,'Runner Up','Sixers','93.8','35.4','83.4','42.4460431654676','3.4','11.8','28.8135593220339','19.6','27.4','71.5328467153285','13.2','29.6','42.8','18.4','7.8','4.8','12.4','25');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (45,2002,'Champion','Lakers','106','36.5','72.25','50.5190311418685','7.25','15.25','47.5409836065574','25.75','35.25','73.0496453900709','10.75','33.25','44','23','7','7','15','19.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (46,2002,'Runner Up','Nets','96.75','38.75','88.75','43.6619718309859','4.5','14.75','30.5084745762712','14.75','22','67.0454545454545','15','24','39','21.5','9.5','4.5','11.25','26.25');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (47,2003,'Champion','Spurs','87.8333333333333','32.1666666666667','74.5','43.1767337807606','4','12.5','32','19.5','27.6666666666667','70.4819277108434','12.3333333333333','33.5','45.8333333333333','18.1666666666667','7.83333333333333','9.83333333333333','15.8333333333333','20.5');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (48,2003,'Runner Up','Nets','82','30.3333333333333','82','36.9918699186992','3.83333333333333','13.8333333333333','27.710843373494','17.5','22.3333333333333','78.3582089552239','14.3333333333333','28.1666666666667','42.5','16.6666666666667','7.83333333333333','6.33333333333333','13.6666666666667','24.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (49,2004,'Champion','Pistons','90.8','31.4','73.2','42.896174863388','4.2','13.2','31.8181818181818','23.8','34.2','69.5906432748538','14.4','31.2','45.6','17.8','7.8','4','12.6','20.6');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (50,2004,'Runner Up','Lakers','81.8','31.6','76','41.5789473684211','4.4','17.8','24.7191011235955','14.2','22.2','63.963963963964','10.4','27.2','37.6','20.6','7.2','2.8','13.2','28.4');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (51,2005,'Champion','Spurs','84.8571428571429','30.8571428571429','71.8571428571429','42.9423459244533','7.28571428571429','18.2857142857143','39.84375','15.8571428571429','22.7142857142857','69.811320754717','12.2857142857143','29.4285714285714','41.7142857142857','16.4285714285714','4.57142857142857','5.57142857142857','15','20.2857142857143');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (52,2005,'Runner Up','Pistons','86.7142857142857','35.4285714285714','81.5714285714286','43.4325744308231','2.57142857142857','10.7142857142857','24','13.2857142857143','18','73.8095238095238','13.7142857142857','27.2857142857143','41','18.5714285714286','9','7.57142857142857','8.71428571428571','21.2857142857143');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (53,2006,'Champion','Heat','92.8333333333333','33.3333333333333','72.8333333333333','45.766590389016','5.33333333333333','17.5','30.4761904761905','20.8333333333333','34.5','60.3864734299517','10.5','33.3333333333333','43.8333333333333','16.6666666666667','7.83333333333333','3.83333333333333','16','24.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (54,2006,'Runner Up','Mavericks','91.8333333333333','33','78.1666666666667','42.2174840085288','5.5','19.3333333333333','28.448275862069','20.3333333333333','25.8333333333333','78.7096774193548','10.1666666666667','31.6666666666667','41.8333333333333','15.8333333333333','7.33333333333333','3.33333333333333','14.5','27.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (55,2007,'Champion','Spurs','86.5','32','72','44.4444444444444','7.25','19.5','37.1794871794872','15.25','23','66.304347826087','10.75','33','43.75','16.75','6','3.75','13','18');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (56,2007,'Runner Up','Cavaliers','80.5','31','78.5','39.4904458598726','5.5','18.75','29.3333333333333','13','18.75','69.3333333333333','12.25','28.75','41','16.5','6.25','2.75','11','19');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (57,2008,'Champion','Celtics','102.166666666667','34.3333333333333','77.3333333333333','44.3965517241379','8.66666666666667','20.1666666666667','42.9752066115702','24.8333333333333','31.8333333333333','78.0104712041885','10.8333333333333','31.3333333333333','42.1666666666667','23','8.66666666666667','4','12.8333333333333','24.6666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (58,2008,'Runner Up','Lakers','93.8333333333333','33','74.8333333333333','44.097995545657','7.16666666666667','20.6666666666667','34.6774193548387','20.6666666666667','28.3333333333333','72.9411764705882','8.16666666666667','29','37.1666666666667','19.3333333333333','6.83333333333333','3.16666666666667','13.5','26');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (59,2009,'Champion','Lakers','100.6','38','83.2','45.6730769230769','6.4','17.2','37.2093023255814','18.2','24','75.8333333333333','10.6','30','40.6','16.4','7.2','5.2','10','24.2');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (60,2009,'Runner Up','Magic','91.2','32.2','75.2','42.8191489361702','7.6','23','33.0434782608696','19.2','27.8','69.0647482014388','7.6','30.6','38.2','18.4','6','6','14','22');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (61,2010,'Champion','Lakers','90.5714285714286','31.8571428571429','76.2857142857143','41.7602996254682','5','17.8571428571429','28','21.8571428571429','28.5714285714286','76.5','13.1428571428571','29.2857142857143','42.4285714285714','14.5714285714286','7.28571428571429','6.14285714285714','12.4285714285714','22.2857142857143');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (62,2010,'Runner Up','Celtics','87.1428571428571','33','76.1428571428571','43.3395872420263','4.71428571428571','15.2857142857143','30.8411214953271','16.4285714285714','21.2857142857143','77.1812080536913','10.1428571428571','27.7142857142857','37.8571428571429','19.7142857142857','7','4.28571428571429','13.1428571428571','24.8571428571429');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (63,2011,'Champion','Mavericks','94.6666666666667','33','72.6666666666667','45.4128440366972','8.5','20.6666666666667','41.1290322580645','20.1666666666667','25.8333333333333','78.0645161290323','9.16666666666667','28.5','37.6666666666667','18.1666666666667','7.16666666666667','4','13.1666666666667','19.6666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (64,2011,'Runner Up','Heat','92.3333333333333','33.6666666666667','74.6666666666667','45.0892857142857','7.5','21.6666666666667','34.6153846153846','17.5','24.6666666666667','70.9459459459459','10.6666666666667','27.8333333333333','38.5','19.5','8','4.5','12.8333333333333','21.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (65,2012,'Champion','Heat','99.6666666666667','35.3333333333333','77','45.8874458874459','8.33333333333333','20.5','40.650406504065','20.6666666666667','25.5','81.0457516339869','9.66666666666667','31.5','41.1666666666667','18.3333333333333','6.16666666666667','3.5','10.8333333333333','18.3333333333333');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (66,2012,'Runner Up','Thunder','98','36.6','80.4','45.5223880597015','6.4','21','30.4761904761905','18.4','23.8','77.3109243697479','9.8','28.2','38','15.8','7.2','5','11','22.4');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (67,2013,'Champion','Heat','98.5','38','82.1666666666667','46.2474645030426','9.33333333333333','20.5','45.5284552845528','13.1666666666667','16.8333333333333','78.2178217821782','10','28.6666666666667','38.6666666666667','21.3333333333333','9.5','5.66666666666667','12.5','22.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (68,2013,'Runner Up','Spurs','97.7142857142857','35.8571428571429','79.5714285714286','45.0628366247756','8.71428571428571','21.4285714285714','40.6666666666667','17.2857142857143','22.5714285714286','76.5822784810127','10.5714285714286','31.2857142857143','41.8571428571429','18.4285714285714','7','4.28571428571429','13.5714285714286','16.8571428571429');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (69,2014,'Champion','Spurs','105.6','38.2','72.4','52.7624309392265','11','23.6','46.6101694915254','18.2','24.4','74.5901639344262','7.8','30','37.8','25.4','8','3.4','13.4','19.8');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (70,2014,'Runner Up','Heat','91.6','33.6','71.2','47.1910112359551','9.2','23.2','39.6551724137931','15.2','20.6','73.7864077669903','5.6','26.6','32.2','15.2','8','2.2','14.4','23');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (71,2015,'Champion','Warriors','100.666666666667','36.1666666666667','83','43.574297188755','11.1666666666667','31','36.0215053763441','17.1666666666667','24.8333333333333','69.1275167785235','10.5','33.6666666666667','44.1666666666667','23','8','5','12.6666666666667','24.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (72,2015,'Runner Up','Cavaliers','93.5','32.6666666666667','85.1666666666667','38.3561643835616','8.16666666666667','27.8333333333333','29.3413173652695','20','28.5','70.1754385964912','12.5','35','47.5','15.8333333333333','7.5','5','12.1666666666667','22.1666666666667');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (73,2016,'Champion','Cavaliers','100.428571428571','37.5714285714286','82.4285714285714','45.580589254766','8','24.2857142857143','32.9411764705882','17.2857142857143','23.8571428571429','72.4550898203593','11.7142857142857','32.1428571428571','43.8571428571429','18','9.28571428571429','5.42857142857143','13.2857142857143','21');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (74,2016,'Runner Up','Warriors','99.8571428571429','35.5714285714286','82.5714285714286','43.0795847750865','13.4285714285714','36','37.3015873015873','15.2857142857143','20.7142857142857','73.7931034482759','10.2857142857143','29.5714285714286','39.8571428571429','22.5714285714286','6.57142857142857','5.71428571428571','13.7142857142857','21.4285714285714');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (75,2017,'Champion','Warriors','121.6','43.2','91','47.4725274725275','14.2','37.2','38.1720430107527','21','25.6','82.03125','12.2','33.6','45.8','29.4','7.6','4.4','13.4','24.4');
INSERT INTO CHAMP(FIELD1,Year,Status,Team,PTS,FG,FGA,FGP,TP,TPA,TPP,FT,FTA,FTP,ORB,DRB,TRB,AST,STL,BLK,TOV,PF) VALUES (76,2017,'Runner Up','Cavaliers','114.8','41.6','90.2','46.119733924612','13.2','34.6','38.150289017341','18.4','24.6','74.7967479674797','11.6','32','43.6','21.6','7.2','3.6','13.2','22.4');

ALTER TABLE CHAMP DROP PRIMARY KEY;
ALTER TABLE CHAMP ADD PRIMARY KEY(Year,Status);

DROP TABLE IF EXISTS 2KPLAYER;
CREATE TABLE 2KPLAYER(
  full_name varchar(30),
  rating varchar(3)
);

LOAD DATA local INFILE '/home/zliu167/public_html/data_final_project/nba2k-full.csv' 
INTO TABLE 2KPLAYER
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

SELECT * FROM 2KPLAYER;




drop table Passwords;
create table Passwords (
  CurPasswords  VARCHAR(28)
);

INSERT INTO Passwords VALUES ('databasesfinalproject');
-- INSERT INTO Passwords VALUES ('databasesfinalproject');

SELECT * FROM Passwords;




SELECT DISTINCT I.Position FROM INJURY I;

DROP TABLE IF EXISTS INJURY_TYPE;
CREATE TABLE INJURY_TYPE(
   Origintype VARCHAR(9) NOT NULL,
   threetype VARCHAR(9) NOT NULL);

INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('C','C');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('F','F');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('G','G');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('SG','G');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('PG','G');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('PF','PF');
INSERT INTO INJURY_TYPE(Origintype,threetype) VALUES ('SF','SF');

SELECT * FROM INJURY_TYPE;